% function dSr=QAMdemod(rX,Nsc,M)
% %   QAMdemod Demodula M-QAM según el estandar 3GPP para LTE
% %
% %   rX    - simbolos de entrada
% %   Nsc   - N de portadoras de datos
% %   M     - Tipo de modulación {16,64}
% %
% 
% dSr=[];
% switch M
%     case 16
%         rX=rX*sqrt(10);
%         for s=1:Nsc
%             if real(rX(s))<-2
%                 if imag(rX(s))>2
%                     dSr=[dSr 1 0 1 1];  %-3+3j
%                 elseif imag(rX(s))>0
%                     dSr=[dSr 1 0 1 0];  %-3+1j
%                 elseif imag(rX(s))>-2
%                     dSr=[dSr 1 1 1 0];  %-3-1j
%                 else
%                     dSr=[dSr 1 1 1 1];  %-3-3j
%                 end
%             elseif real(rX(s))<0
%                 if imag(rX(s))>2
%                     dSr=[dSr 1 0 0 1];  %-1+3j
%                 elseif imag(rX(s))>0
%                     dSr=[dSr 1 0 0 0];  %-1+1j
%                 elseif imag(rX(s))>-2
%                     dSr=[dSr 1 1 0 0];  %-1-1j
%                 else
%                     dSr=[dSr 1 1 0 1];  %-1-3j
%                 end
%             elseif real(rX(s))<2
%                 if imag(rX(s))>2
%                     dSr=[dSr 0 0 0 1];  %1+3j
%                 elseif imag(rX(s))>0
%                     dSr=[dSr 0 0 0 0];  %1+1j
%                 elseif imag(rX(s))>-2
%                     dSr=[dSr 0 1 0 0];  %1-1j
%                 else
%                     dSr=[dSr 0 1 0 1];  %1-3j
%                 end
%             else
%                 if imag(rX(s))>2
%                     dSr=[dSr 0 0 1 1];  %3+3j
%                 elseif imag(rX(s))>0
%                     dSr=[dSr 0 0 1 0];  %3+1j
%                 elseif imag(rX(s))>-2
%                     dSr=[dSr 0 1 1 0];  %3-1j
%                 else
%                     dSr=[dSr 0 1 1 1];  %3-3j
%                 end
%             end
%         end
%     case 64
%         rX=rX*sqrt(42);
%         for s=1:Nsc
%             if real(rX(s))<-6
%                 if imag(rX(s))>6 %-7+7j
%                     dSr=[dSr 1 0 1 1 1 1];
%                 elseif imag(rX(s))>4 %-7+5j
%                     dSr=[dSr 1 0 1 1 1 0];
%                 elseif imag(rX(s))>2 %-7+3j
%                     dSr=[dSr 1 0 1 0 1 0];
%                 elseif imag(rX(s))>0 %-7+1j
%                     dSr=[dSr 1 0 1 0 1 1];
%                 elseif imag(rX(s))<-6 %-7-7j
%                     dSr=[dSr 1 1 1 1 1 1];
%                 elseif imag(rX(s))<-4 %-7-5j
%                     dSr=[dSr 1 1 1 1 1 0];
%                 elseif imag(rX(s))<-2 %-7-3j
%                     dSr=[dSr 1 1 1 0 1 0];
%                 else                  %-7-1j
%                     dSr=[dSr 1 1 1 0 1 1];
%                 end
%             elseif real(rX(s))<-4
%                 if imag(rX(s))>6 %-5+7j
%                     dSr=[dSr 1 0 1 1 0 1];
%                 elseif imag(rX(s))>4 %-5+5j
%                     dSr=[dSr 1 0 1 1 0 0];
%                 elseif imag(rX(s))>2 %-5+3j
%                     dSr=[dSr 1 0 1 0 0 0];
%                 elseif imag(rX(s))>0 %-5+1j
%                     dSr=[dSr 1 0 1 0 0 1];
%                 elseif imag(rX(s))<-6 %-5-7j
%                     dSr=[dSr 1 1 1 1 0 1];
%                 elseif imag(rX(s))<-4 %-5-5j
%                     dSr=[dSr 1 1 1 1 0 0];
%                 elseif imag(rX(s))<-2 %-5-3j
%                     dSr=[dSr 1 1 1 0 0 0];
%                 else                  %-5-1j
%                     dSr=[dSr 1 1 1 0 0 1];
%                 end
%             elseif real(rX(s))<-2
%                 if imag(rX(s))>6 %-3+7j
%                     dSr=[dSr 1 0 0 1 0 1];
%                 elseif imag(rX(s))>4 %-3+5j
%                     dSr=[dSr 1 0 0 1 0 0];
%                 elseif imag(rX(s))>2 %-3+3j
%                     dSr=[dSr 1 0 0 0 0 0];
%                 elseif imag(rX(s))>0 %-3+1j
%                     dSr=[dSr 1 0 0 0 0 1];
%                 elseif imag(rX(s))<-6 %-3-7j
%                     dSr=[dSr 1 1 0 1 0 1];
%                 elseif imag(rX(s))<-4 %-3-5j
%                     dSr=[dSr 1 1 0 1 0 0];
%                 elseif imag(rX(s))<-2 %-3-3j
%                     dSr=[dSr 1 1 0 0 0 0];
%                 else                  %-3-1j
%                     dSr=[dSr 1 1 0 0 0 1];
%                 end
%             elseif real(rX(s))<0
%                 if imag(rX(s))>6 %-1+7j
%                     dSr=[dSr 1 0 0 1 1 1];
%                 elseif imag(rX(s))>4 %-1+5j
%                     dSr=[dSr 1 0 0 1 1 0];
%                 elseif imag(rX(s))>2 %-1+3j
%                     dSr=[dSr 1 0 0 0 1 0];
%                 elseif imag(rX(s))>0 %-1+1j
%                     dSr=[dSr 1 0 0 0 1 1];
%                 elseif imag(rX(s))<-6 %-1-7j
%                     dSr=[dSr 1 1 0 1 1 1];
%                 elseif imag(rX(s))<-4 %-1-5j
%                     dSr=[dSr 1 1 0 1 1 0];
%                 elseif imag(rX(s))<-2 %-1-3j
%                     dSr=[dSr 1 1 0 0 1 0];
%                 else                  %-1-1j
%                     dSr=[dSr 1 1 0 0 1 1];
%                 end
%             elseif real(rX(s))>6
%                 if imag(rX(s))>6 %7+7j
%                     dSr=[dSr 0 0 1 1 1 1];
%                 elseif imag(rX(s))>4 %7+5j
%                     dSr=[dSr 0 0 1 1 1 0];
%                 elseif imag(rX(s))>2 %7+3j
%                     dSr=[dSr 0 0 1 0 1 0];
%                 elseif imag(rX(s))>0 %7+1j
%                     dSr=[dSr 0 0 1 0 1 1];
%                 elseif imag(rX(s))<-6 %7-7j
%                     dSr=[dSr 0 1 1 1 1 1];
%                 elseif imag(rX(s))<-4 %7-5j
%                     dSr=[dSr 0 1 1 1 1 0];
%                 elseif imag(rX(s))<-2 %7-3j
%                     dSr=[dSr 0 1 1 0 1 0];
%                 else                  %7-1j
%                     dSr=[dSr 0 1 1 0 1 1];
%                 end
%             elseif real(rX(s))>4
%                 if imag(rX(s))>6 %5+7j
%                     dSr=[dSr 0 0 1 1 0 1];
%                 elseif imag(rX(s))>4 %5+5j
%                     dSr=[dSr 0 0 1 1 0 0];
%                 elseif imag(rX(s))>2 %5+3j
%                     dSr=[dSr 0 0 1 0 0 0];
%                 elseif imag(rX(s))>0 %5+1j
%                     dSr=[dSr 0 0 1 0 0 1];
%                 elseif imag(rX(s))<-6 %5-7j
%                     dSr=[dSr 0 1 1 1 0 1];
%                 elseif imag(rX(s))<-4 %5-5j
%                     dSr=[dSr 0 1 1 1 0 0];
%                 elseif imag(rX(s))<-2 %5-3j
%                     dSr=[dSr 0 1 1 0 0 0];
%                 else                  %5-1j
%                     dSr=[dSr 0 1 1 0 0 1];
%                 end
%             elseif real(rX(s))>2
%                 if imag(rX(s))>6 %3+7j
%                     dSr=[dSr 0 0 0 1 0 1];
%                 elseif imag(rX(s))>4 %3+5j
%                     dSr=[dSr 0 0 0 1 0 0];
%                 elseif imag(rX(s))>2 %3+3j
%                     dSr=[dSr 0 0 0 0 0 0];
%                 elseif imag(rX(s))>0 %3+1j
%                     dSr=[dSr 0 0 0 0 0 1];
%                 elseif imag(rX(s))<-6 %3-7j
%                     dSr=[dSr 0 1 0 1 0 1];
%                 elseif imag(rX(s))<-4 %3-5j
%                     dSr=[dSr 0 1 0 1 0 0];
%                 elseif imag(rX(s))<-2 %3-3j
%                     dSr=[dSr 0 1 0 0 0 0];
%                 else                  %3-1j
%                     dSr=[dSr 0 1 0 0 0 1];
%                 end
%             else 
%                 if imag(rX(s))>6 %1+7j
%                     dSr=[dSr 0 0 0 1 1 1];
%                 elseif imag(rX(s))>4 %1+5j
%                     dSr=[dSr 0 0 0 1 1 0];
%                 elseif imag(rX(s))>2 %1+3j
%                     dSr=[dSr 0 0 0 0 1 0];
%                 elseif imag(rX(s))>0 %1+1j
%                     dSr=[dSr 0 0 0 0 1 1];
%                 elseif imag(rX(s))<-6 %1-7j
%                     dSr=[dSr 0 1 0 1 1 1];
%                 elseif imag(rX(s))<-4 %1-5j
%                     dSr=[dSr 0 1 0 1 1 0];
%                 elseif imag(rX(s))<-2 %1-3j
%                     dSr=[dSr 0 1 0 0 1 0];
%                 else                  %1-1j
%                     dSr=[dSr 0 1 0 0 1 1];
%                 end
%             end
%         end        
% end
% end

function dSr=QAMdemod(rX,Na,M)
%   QAMdemod Demodula M-QAM según el estandar 3GPP para LTE. La salida son
%   los LLR de bit en forma de vector columna
%
%   rX    - simbolos complejos de entrada
%   Nsc  - nº portadoras totales
%   Na   - N de portadoras de datos
%   M     - Tipo de modulación {16,64}
%   snr   - SNR (dB)
%   H     - respuesta en frecuencia
%

% representaciones en binario (sumadas 1 para indexar)
b0000 = 1;      % 16QAM
b0001 = 2;
b0010 = 3;
b0011 = 4;
b0100 = 5;
b0101 = 6;
b0110 = 7;
b0111 = 8;
b1000 = 9;
b1001 = 10;
b1010 = 11;
b1011 = 12;
b1100 = 13;
b1101 = 14;
b1110 = 15;
b1111 = 16;

b000000 = 1;		% 64QAM
b000001 = 2;
b000010 = 3;
b000011 = 4;
b000100 = 5;
b000101 = 6;
b000110 = 7;
b000111 = 8;
b001000 = 9;
b001001 = 10;
b001010 = 11;
b001011 = 12;
b001100 = 13;
b001101 = 14;
b001110 = 15;
b001111 = 16;
b010000 = 17;
b010001 = 18;
b010010 = 19;
b010011 = 20;
b010100 = 21;
b010101 = 22;
b010110 = 23;
b010111 = 24;
b011000 = 25;
b011001 = 26;
b011010 = 27;
b011011 = 28;
b011100 = 29;
b011101 = 30;
b011110 = 31;
b011111 = 32;
b100000 = 33;
b100001 = 34;
b100010 = 35;
b100011 = 36;
b100100 = 37;
b100101 = 38;
b100110 = 39;
b100111 = 40;
b101000 = 41;
b101001 = 42;
b101010 = 43;
b101011 = 44;
b101100 = 45;
b101101 = 46;
b101110 = 47;
b101111 = 48;
b110000 = 49;
b110001 = 50;
b110010 = 51;
b110011 = 52;
b110100 = 53;
b110101 = 54;
b110110 = 55;
b110111 = 56;
b111000 = 57;
b111001 = 58;
b111010 = 59;
b111011 = 60;
b111100 = 61;
b111101 = 62;
b111110 = 63;
b111111 = 64;

switch M
    case 16
        dSr=zeros(4*Na, 1);
        c = 1/sqrt(10);
        rX=rX/c;
        modI = [1 1 3 3 1 1 3 3 -1 -1 -3 -3 -1 -1 -3 -3];     % parte real de los símbolos de la constelación 0000 .. 1111
        modQ = [1 3 1 3 -1 -3 -1 -3 1 3 1 3 -1 -3 -1 -3];     % parte imaginaria de los símbolos de la constelación 0000 .. 1111
        
        % Cálculo de la distancia a todos los símbolos
        rX = repmat(rX,1,M);
        modI=repmat(modI,Na,1);
        modQ=repmat(modQ,Na,1);
        dcuad=(real(rX)-modI).^2+(imag(rX)-modQ).^2;
        dcuad_simb =(c^2)*dcuad;
        min_dist = min(dcuad_simb,[],2);
        N_AWGN = mean(min_dist);
        
        N_post = N_AWGN;
        
        %bit 0
        min_0 = min([dcuad(:,b0000), dcuad(:,b0001), ...
                     dcuad(:,b0010), dcuad(:,b0011), ...
                     dcuad(:,b0100), dcuad(:,b0101), ...
                     dcuad(:,b0110), dcuad(:,b0111)],[],2);
        min_1 = min([dcuad(:,b1000), dcuad(:,b1001), ...
                     dcuad(:,b1010), dcuad(:,b1011), ...
                     dcuad(:,b1100), dcuad(:,b1101), ...
                     dcuad(:,b1110), dcuad(:,b1111)],[],2);
        lambda_0=(min_1-min_0)/N_post;

        %bit1
        min_0 = min([dcuad(:,b0000), dcuad(:,b0001), ...
                     dcuad(:,b0010), dcuad(:,b0011), ...
                     dcuad(:,b1000), dcuad(:,b1001), ...
                     dcuad(:,b1010), dcuad(:,b1011)],[],2);
        min_1 = min([dcuad(:,b0100), dcuad(:,b0101), ...
                     dcuad(:,b0110), dcuad(:,b0111), ...
                     dcuad(:,b1100), dcuad(:,b1101), ...
                     dcuad(:,b1110), dcuad(:,b1111)],[],2);
        lambda_1=(min_1-min_0)/N_post;

        %bit 2
        min_0 = min([dcuad(:,b0000), dcuad(:,b0001), ...
                     dcuad(:,b0100), dcuad(:,b0101), ...
                     dcuad(:,b1000), dcuad(:,b1001), ...
                     dcuad(:,b1100), dcuad(:,b1101)],[],2);
        min_1 = min([dcuad(:,b0010), dcuad(:,b0011), ...
                     dcuad(:,b0110), dcuad(:,b0111), ...
                     dcuad(:,b1010), dcuad(:,b1011), ...
                     dcuad(:,b1110), dcuad(:,b1111)],[],2);
        lambda_2=(min_1-min_0)/N_post;

        %bit 3
        min_0 = min([dcuad(:,b0000), dcuad(:,b0010), ...
                     dcuad(:,b0100), dcuad(:,b0110), ...
                     dcuad(:,b1000), dcuad(:,b1010), ...
                     dcuad(:,b1100), dcuad(:,b1110)],[],2);
        min_1 = min([dcuad(:,b0001), dcuad(:,b0011), ...
                     dcuad(:,b0101), dcuad(:,b0111), ...
                     dcuad(:,b1001), dcuad(:,b1011), ...
                     dcuad(:,b1101), dcuad(:,b1111)],[],2);
        lambda_3=(min_1-min_0)/N_post;
        
        dSr(1:4:end-3) = lambda_0;
        dSr(2:4:end-2) = lambda_1;
        dSr(3:4:end-1) = lambda_2;
        dSr(4:4:end) = lambda_3;
        
%         % Primer bucle para calcular la distancia media, que es la potencia
%         % de ruido
%         for s=1:Na
%             dcuad = (real(rX(s))*c-modI*c).^2 + (imag(rX(s))*c-modQ*c).^2;
%             % Me quedo con la mínima
%             min_dist(s) = min(dcuad);
%         end
%         N_AWGN = mean(min_dist);
% %         N_AWGN = 10^(-snr/10);
%         
%         % Demodulación de los bits
%         for s=1:Na
%             dcuad = (real(rX(s))-modI).^2 + (imag(rX(s))-modQ).^2;
% %             indice = (Nsc-Na)/2 + s + (s > Na/2);
% %             N_post = N_AWGN / (H(indice)*H(indice)');   % ruido de post-detección con ZF
%             N_post = N_AWGN;
%             
%             %bit 0
%             min_0 = min([dcuad(b0000), dcuad(b0001), ...
%                          dcuad(b0010), dcuad(b0011), ...
%                          dcuad(b0100), dcuad(b0101), ...
%                          dcuad(b0110), dcuad(b0111)]);
%             min_1 = min([dcuad(b1000), dcuad(b1001), ...
%                          dcuad(b1010), dcuad(b1011), ...
%                          dcuad(b1100), dcuad(b1101), ...
%                          dcuad(b1110), dcuad(b1111)]);
%             lambda_0=(min_1-min_0)/N_post;
% 
%             %bit1
%             min_0 = min([dcuad(b0000), dcuad(b0001), ...
%                          dcuad(b0010), dcuad(b0011), ...
%                          dcuad(b1000), dcuad(b1001), ...
%                          dcuad(b1010), dcuad(b1011)]);
%             min_1 = min([dcuad(b0100), dcuad(b0101), ...
%                          dcuad(b0110), dcuad(b0111), ...
%                          dcuad(b1100), dcuad(b1101), ...
%                          dcuad(b1110), dcuad(b1111)]);
%             lambda_1=(min_1-min_0)/N_post;
%             
%             %bit 2
%             min_0 = min([dcuad(b0000), dcuad(b0001), ...
%                          dcuad(b0100), dcuad(b0101), ...
%                          dcuad(b1000), dcuad(b1001), ...
%                          dcuad(b1100), dcuad(b1101)]);
%             min_1 = min([dcuad(b0010), dcuad(b0011), ...
%                          dcuad(b0110), dcuad(b0111), ...
%                          dcuad(b1010), dcuad(b1011), ...
%                          dcuad(b1110), dcuad(b1111)]);
%             lambda_2=(min_1-min_0)/N_post;
% 
%             %bit 3
%             min_0 = min([dcuad(b0000), dcuad(b0010), ...
%                          dcuad(b0100), dcuad(b0110), ...
%                          dcuad(b1000), dcuad(b1010), ...
%                          dcuad(b1100), dcuad(b1110)]);
%             min_1 = min([dcuad(b0001), dcuad(b0011), ...
%                          dcuad(b0101), dcuad(b0111), ...
%                          dcuad(b1001), dcuad(b1011), ...
%                          dcuad(b1101), dcuad(b1111)]);
%             lambda_3=(min_1-min_0)/N_post;
%             
%             dSr(4*(s-1)+1) = lambda_0;
%             dSr(4*(s-1)+2) = lambda_1;
%             dSr(4*(s-1)+3) = lambda_2;
%             dSr(4*(s-1)+4) = lambda_3;
%             
%             for i=1:16
%                 ind(i,:)=dec2bin(i-1,4);
% 
%                 if strcmp(ind(i,:), '0000')
%                     aux1=1;aux2=1;
%                 elseif strcmp(ind(i,:), '0001') 
%                     aux1=1;aux2=3;
%                 elseif strcmp(ind(i,:), '0010')
%                     aux1=3;aux2=1;  
%                 elseif strcmp(ind(i,:), '0011')
%                     aux1=3;aux2=3;
%                 elseif strcmp(ind(i,:), '0100')
%                     aux1=1;aux2=-1;
%                 elseif strcmp(ind(i,:), '0101') 
%                     aux1=1;aux2=-3;
%                 elseif strcmp(ind(i,:), '0110')
%                     aux1=3;aux2=-1;  
%                 elseif strcmp(ind(i,:), '0111')
%                     aux1=3;aux2=-3;
%                 elseif strcmp(ind(i,:), '1000')
%                     aux1=-1;aux2=1;
%                 elseif strcmp(ind(i,:), '1001') 
%                     aux1=-1;aux2=3;
%                 elseif strcmp(ind(i,:), '1010')
%                     aux1=-3;aux2=1;  
%                 elseif strcmp(ind(i,:), '1011')
%                     aux1=-3;aux2=3;
%                 elseif strcmp(ind(i,:), '1100')
%                     aux1=-1;aux2=-1;
%                 elseif strcmp(ind(i,:), '1101') 
%                     aux1=-1;aux2=-3;
%                 elseif strcmp(ind(i,:), '1110')
%                     aux1=-3;aux2=-1;  
%                 elseif strcmp(ind(i,:), '1111')
%                     aux1=-3;aux2=-3;
%                 end
% 
%                 dcuad(i)=(real(rX(s))-aux1)^2 + (imag(rX(s))-aux2)^2;
%                 dist_ind{i,1}=ind(i,:);
%                 dist_ind{i,2}=dcuad(i);
%             end

%             %bit0
%             min_0=min([dcuad(find(strcmp(dist_ind, '0000'))),dcuad(find(strcmp(dist_ind, '0001'))),...
%                 dcuad(find(strcmp(dist_ind, '0010'))),dcuad(find(strcmp(dist_ind, '0011'))),...
%                 dcuad(find(strcmp(dist_ind, '0100'))),dcuad(find(strcmp(dist_ind, '0101'))),...
%                 dcuad(find(strcmp(dist_ind, '0110'))),dcuad(find(strcmp(dist_ind, '0111')))]);
%             
% 
%             min_1=min([dcuad(find(strcmp(dist_ind, '1000'))),dcuad(find(strcmp(dist_ind, '1001'))),...
%                 dcuad(find(strcmp(dist_ind, '1010'))),dcuad(find(strcmp(dist_ind, '1011'))),...
%                 dcuad(find(strcmp(dist_ind, '1100'))),dcuad(find(strcmp(dist_ind, '1101'))),...
%                 dcuad(find(strcmp(dist_ind, '1110'))),dcuad(find(strcmp(dist_ind, '1111')))]);
% 
%             lambda_0=(min_1-min_0)/N;
% 
% 
%             %bit1
%             min_0=min([dcuad(find(strcmp(dist_ind, '0000'))),dcuad(find(strcmp(dist_ind, '0001'))),...
%                 dcuad(find(strcmp(dist_ind, '0010'))),dcuad(find(strcmp(dist_ind, '0011'))),...
%                 dcuad(find(strcmp(dist_ind, '1000'))),dcuad(find(strcmp(dist_ind, '1001'))),...
%                 dcuad(find(strcmp(dist_ind, '1010'))),dcuad(find(strcmp(dist_ind, '1011')))]);
% 
%             min_1=min([dcuad(find(strcmp(dist_ind, '0100'))),dcuad(find(strcmp(dist_ind, '0101'))),...
%                 dcuad(find(strcmp(dist_ind, '0110'))),dcuad(find(strcmp(dist_ind, '0111'))),...
%                 dcuad(find(strcmp(dist_ind, '1100'))),dcuad(find(strcmp(dist_ind, '1101'))),...
%                 dcuad(find(strcmp(dist_ind, '1110'))),dcuad(find(strcmp(dist_ind, '1111')))]);
% 
%             lambda_1=(min_1-min_0)/N;
% 
%             %bit2
%             min_0=min([dcuad(find(strcmp(dist_ind, '0000'))),dcuad(find(strcmp(dist_ind, '0001'))),...
%                 dcuad(find(strcmp(dist_ind, '0100'))),dcuad(find(strcmp(dist_ind, '0101'))),...
%                 dcuad(find(strcmp(dist_ind, '1000'))),dcuad(find(strcmp(dist_ind, '1001'))),...
%                 dcuad(find(strcmp(dist_ind, '1100'))),dcuad(find(strcmp(dist_ind, '1101')))]);
% 
%             min_1=min([dcuad(find(strcmp(dist_ind, '0010'))),dcuad(find(strcmp(dist_ind, '0011'))),...
%                 dcuad(find(strcmp(dist_ind, '0110'))),dcuad(find(strcmp(dist_ind, '0111'))),...
%                 dcuad(find(strcmp(dist_ind, '1010'))),dcuad(find(strcmp(dist_ind, '1011'))),...
%                 dcuad(find(strcmp(dist_ind, '1110'))),dcuad(find(strcmp(dist_ind, '1111')))]);
% 
%             lambda_2=(min_1-min_0)/N;
% 
%              %bit3
%             min_0=min([dcuad(find(strcmp(dist_ind, '0000'))),dcuad(find(strcmp(dist_ind, '0010'))),...
%                 dcuad(find(strcmp(dist_ind, '0100'))),dcuad(find(strcmp(dist_ind, '0110'))),...
%                 dcuad(find(strcmp(dist_ind, '1000'))),dcuad(find(strcmp(dist_ind, '1010'))),...
%                 dcuad(find(strcmp(dist_ind, '1100'))),dcuad(find(strcmp(dist_ind, '1110')))]);
% 
%             min_1=min([dcuad(find(strcmp(dist_ind, '0001'))),dcuad(find(strcmp(dist_ind, '0011'))),...
%                 dcuad(find(strcmp(dist_ind, '0101'))),dcuad(find(strcmp(dist_ind, '0111'))),...
%                 dcuad(find(strcmp(dist_ind, '1001'))),dcuad(find(strcmp(dist_ind, '1011'))),...
%                 dcuad(find(strcmp(dist_ind, '1101'))),dcuad(find(strcmp(dist_ind, '1111')))]);
% 
%             lambda_3=(min_1-min_0)/N;
% 
% 
%             dSr=[dSr lambda_0 lambda_1 lambda_2 lambda_3];
    case 64
        dSr=zeros(6*Na, 1);
        c = 1/sqrt(42);
        rX=rX/c;
        % parte real de los símbolos de la constelación 000000 .. 111111
        modI = [3 3 1 1 3 3 1 1 5 5 7 7 5 5 7 7 3 3 1 1 3 3 1 1 5 5 7 7 5 5 7 7 -3 -3 -1 -1 -3 -3 -1 -1 -5 -5 -7 -7 -5 -5 -7 -7 -3 -3 -1 -1 -3 -3 -1 -1 -5 -5 -7 -7 -5 -5 -7 -7];
        % parte imaginaria de los símbolos de la constelación 000000 .. 111111
        modQ = [3 1 3 1 5 7 5 7 3 1 3 1 5 7 5 7 -3 -1 -3 -1 -5 -7 -5 -7 -3 -1 -3 -1 -5 -7 -5 -7 3 1 3 1 5 7 5 7 3 1 3 1 5 7 5 7 -3 -1 -3 -1 -5 -7 -5 -7 -3 -1 -3 -1 -5 -7 -5 -7];

        % Cálculo de la distancia a todos los símbolos
        rX = repmat(rX,1,M);
        modI=repmat(modI,Na,1);
        modQ=repmat(modQ,Na,1);
        dcuad=(real(rX)-modI).^2+(imag(rX)-modQ).^2;
        dcuad_simb =(c^2)*dcuad;
        min_dist = min(dcuad_simb,[],2);
        N_AWGN = mean(min_dist);
        
        N_post = N_AWGN;
        
        min_0 = min([dcuad(:,b000000), dcuad(:,b000001),...
                     dcuad(:,b000010), dcuad(:,b000011),...
                     dcuad(:,b000100), dcuad(:,b000101),...
                     dcuad(:,b000110), dcuad(:,b000111),...
                     dcuad(:,b001000), dcuad(:,b001001),...
                     dcuad(:,b001010), dcuad(:,b001011),...
                     dcuad(:,b001100), dcuad(:,b001101),...
                     dcuad(:,b001110), dcuad(:,b001111),...
                     dcuad(:,b010000), dcuad(:,b010001),...
                     dcuad(:,b010010), dcuad(:,b010011),...
                     dcuad(:,b010100), dcuad(:,b010101),...
                     dcuad(:,b010110), dcuad(:,b010111),...
                     dcuad(:,b011000), dcuad(:,b011001),...
                     dcuad(:,b011010), dcuad(:,b011011),...
                     dcuad(:,b011100), dcuad(:,b011101),...
                     dcuad(:,b011110), dcuad(:,b011111)],[],2);

        min_1 = min([dcuad(:,b100000), dcuad(:,b100001),...
                     dcuad(:,b100010), dcuad(:,b100011),...
                     dcuad(:,b100100), dcuad(:,b100101),...
                     dcuad(:,b100110), dcuad(:,b100111),...
                     dcuad(:,b101000), dcuad(:,b101001),...
                     dcuad(:,b101010), dcuad(:,b101011),...
                     dcuad(:,b101100), dcuad(:,b101101),...
                     dcuad(:,b101110), dcuad(:,b101111),...
                     dcuad(:,b110000), dcuad(:,b110001),...
                     dcuad(:,b110010), dcuad(:,b110011),...
                     dcuad(:,b110100), dcuad(:,b110101),...
                     dcuad(:,b110110), dcuad(:,b110111),...
                     dcuad(:,b111000), dcuad(:,b111001),...
                     dcuad(:,b111010), dcuad(:,b111011),...
                     dcuad(:,b111100), dcuad(:,b111101),...
                     dcuad(:,b111110), dcuad(:,b111111)],[],2);

        lambda_0=(min_1-min_0)/N_post;

        %bit 1
        min_0 = min([dcuad(:,b000000), dcuad(:,b000001),...
                     dcuad(:,b000010), dcuad(:,b000011),...
                     dcuad(:,b000100), dcuad(:,b000101),...
                     dcuad(:,b000110), dcuad(:,b000111),...
                     dcuad(:,b001000), dcuad(:,b001001),...
                     dcuad(:,b001010), dcuad(:,b001011),...
                     dcuad(:,b001100), dcuad(:,b001101),...
                     dcuad(:,b001110), dcuad(:,b001111),...
                     dcuad(:,b100000), dcuad(:,b100001),...
                     dcuad(:,b100010), dcuad(:,b100011),...
                     dcuad(:,b100100), dcuad(:,b100101),...
                     dcuad(:,b100110), dcuad(:,b100111),...
                     dcuad(:,b101000), dcuad(:,b101001),...
                     dcuad(:,b101010), dcuad(:,b101011),...
                     dcuad(:,b101100), dcuad(:,b101101),...
                     dcuad(:,b101110), dcuad(:,b101111)],[],2);

        min_1 = min([dcuad(:,b010000), dcuad(:,b010001),...
                     dcuad(:,b010010), dcuad(:,b010011),...
                     dcuad(:,b010100), dcuad(:,b010101),...
                     dcuad(:,b010110), dcuad(:,b010111),...
                     dcuad(:,b011000), dcuad(:,b011001),...
                     dcuad(:,b011010), dcuad(:,b011011),...
                     dcuad(:,b011100), dcuad(:,b011101),...
                     dcuad(:,b011110), dcuad(:,b011111),...
                     dcuad(:,b110000), dcuad(:,b110001),...
                     dcuad(:,b110010), dcuad(:,b110011),...
                     dcuad(:,b110100), dcuad(:,b110101),...
                     dcuad(:,b110110), dcuad(:,b110111),...
                     dcuad(:,b111000), dcuad(:,b111001),...
                     dcuad(:,b111010), dcuad(:,b111011),...
                     dcuad(:,b111100), dcuad(:,b111101),...
                     dcuad(:,b111110), dcuad(:,b111111)],[],2);

        lambda_1=(min_1-min_0)/N_post;

        %bit 2
        min_0 = min([dcuad(:,b000000), dcuad(:,b000001),...
                     dcuad(:,b000010), dcuad(:,b000011),...
                     dcuad(:,b000100), dcuad(:,b000101),...
                     dcuad(:,b000110), dcuad(:,b000111),...
                     dcuad(:,b010000), dcuad(:,b010001),...
                     dcuad(:,b010010), dcuad(:,b010011),...
                     dcuad(:,b010100), dcuad(:,b010101),...
                     dcuad(:,b010110), dcuad(:,b010111),...
                     dcuad(:,b100000), dcuad(:,b100001),...
                     dcuad(:,b100010), dcuad(:,b100011),...
                     dcuad(:,b100100), dcuad(:,b100101),...
                     dcuad(:,b100110), dcuad(:,b100111),...
                     dcuad(:,b110000), dcuad(:,b110001),...
                     dcuad(:,b110010), dcuad(:,b110011),...
                     dcuad(:,b110100), dcuad(:,b110101),...
                     dcuad(:,b110110), dcuad(:,b110111)],[],2);

        min_1 = min([dcuad(:,b001000), dcuad(:,b001001),...
                     dcuad(:,b001010), dcuad(:,b001011),...
                     dcuad(:,b001100), dcuad(:,b001101),...
                     dcuad(:,b001110), dcuad(:,b001111),...
                     dcuad(:,b011000), dcuad(:,b011001),...
                     dcuad(:,b011010), dcuad(:,b011011),...
                     dcuad(:,b011100), dcuad(:,b011101),...
                     dcuad(:,b011110), dcuad(:,b011111),...
                     dcuad(:,b101000), dcuad(:,b101001),...
                     dcuad(:,b101010), dcuad(:,b101011),...
                     dcuad(:,b101100), dcuad(:,b101101),...
                     dcuad(:,b101110), dcuad(:,b101111),...
                     dcuad(:,b111000), dcuad(:,b111001),...
                     dcuad(:,b111010), dcuad(:,b111011),...
                     dcuad(:,b111100), dcuad(:,b111101),...
                     dcuad(:,b111110), dcuad(:,b111111)],[],2);

        lambda_2=(min_1-min_0)/N_post;

        %bit 3
        min_0 = min([dcuad(:,b000000), dcuad(:,b000001),...
                     dcuad(:,b000010), dcuad(:,b000011),...
                     dcuad(:,b001000), dcuad(:,b001001),...
                     dcuad(:,b001010), dcuad(:,b001011),...
                     dcuad(:,b010000), dcuad(:,b010001),...
                     dcuad(:,b010010), dcuad(:,b010011),...
                     dcuad(:,b011000), dcuad(:,b011001),...
                     dcuad(:,b011010), dcuad(:,b011011),...
                     dcuad(:,b100000), dcuad(:,b100001),...
                     dcuad(:,b100010), dcuad(:,b100011),...
                     dcuad(:,b101000), dcuad(:,b101001),...
                     dcuad(:,b101010), dcuad(:,b101011),...
                     dcuad(:,b110000), dcuad(:,b110001),...
                     dcuad(:,b110010), dcuad(:,b110011),...
                     dcuad(:,b111000), dcuad(:,b111001),...
                     dcuad(:,b111010), dcuad(:,b111011)],[],2);

        min_1 = min([dcuad(:,b000100), dcuad(:,b000101),...
                     dcuad(:,b000110), dcuad(:,b000111),...
                     dcuad(:,b001100), dcuad(:,b001101),...
                     dcuad(:,b001110), dcuad(:,b001111),...
                     dcuad(:,b010100), dcuad(:,b010101),...
                     dcuad(:,b010110), dcuad(:,b010111),...
                     dcuad(:,b011100), dcuad(:,b011101),...
                     dcuad(:,b011110), dcuad(:,b011111),...
                     dcuad(:,b100100), dcuad(:,b100101),...
                     dcuad(:,b100110), dcuad(:,b100111),...
                     dcuad(:,b101100), dcuad(:,b101101),...
                     dcuad(:,b101110), dcuad(:,b101111),...
                     dcuad(:,b110100), dcuad(:,b110101),...
                     dcuad(:,b110110), dcuad(:,b110111),...
                     dcuad(:,b111100), dcuad(:,b111101),...
                     dcuad(:,b111110), dcuad(:,b111111)],[],2);

        lambda_3=(min_1-min_0)/N_post;

        %bit 4
        min_0 = min([dcuad(:,b000000), dcuad(:,b000001),...
                     dcuad(:,b000100), dcuad(:,b000101),...
                     dcuad(:,b001000), dcuad(:,b001001),...
                     dcuad(:,b001100), dcuad(:,b001101),...
                     dcuad(:,b010000), dcuad(:,b010001),...
                     dcuad(:,b010100), dcuad(:,b010101),...
                     dcuad(:,b011000), dcuad(:,b011001),...
                     dcuad(:,b011100), dcuad(:,b011101),...
                     dcuad(:,b100000), dcuad(:,b100001),...
                     dcuad(:,b100100), dcuad(:,b100101),...
                     dcuad(:,b101000), dcuad(:,b101001),...
                     dcuad(:,b101100), dcuad(:,b101101),...
                     dcuad(:,b110000), dcuad(:,b110001),...
                     dcuad(:,b110100), dcuad(:,b110101),...
                     dcuad(:,b111000), dcuad(:,b111001),...
                     dcuad(:,b111100), dcuad(:,b111101)],[],2);

        min_1 = min([dcuad(:,b000010), dcuad(:,b000011),...
                     dcuad(:,b000110), dcuad(:,b000111),...
                     dcuad(:,b001010), dcuad(:,b001011),...
                     dcuad(:,b001110), dcuad(:,b001111),...
                     dcuad(:,b010010), dcuad(:,b010011),...
                     dcuad(:,b010110), dcuad(:,b010111),...
                     dcuad(:,b011010), dcuad(:,b011011),...
                     dcuad(:,b011110), dcuad(:,b011111),...
                     dcuad(:,b100010), dcuad(:,b100011),...
                     dcuad(:,b100110), dcuad(:,b100111),...
                     dcuad(:,b101010), dcuad(:,b101011),...
                     dcuad(:,b101110), dcuad(:,b101111),...
                     dcuad(:,b110010), dcuad(:,b110011),...
                     dcuad(:,b110110), dcuad(:,b110111),...
                     dcuad(:,b111010), dcuad(:,b111011),...
                     dcuad(:,b111110), dcuad(:,b111111)],[],2);

        lambda_4=(min_1-min_0)/N_post;

        %bit 5
        min_0 = min([dcuad(:,b000000), dcuad(:,b000010),...
                     dcuad(:,b000100), dcuad(:,b000110),...
                     dcuad(:,b001000), dcuad(:,b001010),...
                     dcuad(:,b001100), dcuad(:,b001110),...
                     dcuad(:,b010000), dcuad(:,b010010),...
                     dcuad(:,b010100), dcuad(:,b010110),...
                     dcuad(:,b011000), dcuad(:,b011010),...
                     dcuad(:,b011100), dcuad(:,b011110),...
                     dcuad(:,b100000), dcuad(:,b100010),...
                     dcuad(:,b100100), dcuad(:,b100110),...
                     dcuad(:,b101000), dcuad(:,b101010),...
                     dcuad(:,b101100), dcuad(:,b101110),...
                     dcuad(:,b110000), dcuad(:,b110010),...
                     dcuad(:,b110100), dcuad(:,b110110),...
                     dcuad(:,b111000), dcuad(:,b111010),...
                     dcuad(:,b111100), dcuad(:,b111110)],[],2);

        min_1 = min([dcuad(:,b000001), dcuad(:,b000011),...
                     dcuad(:,b000101), dcuad(:,b000111),...
                     dcuad(:,b001001), dcuad(:,b001011),...
                     dcuad(:,b001101), dcuad(:,b001111),...
                     dcuad(:,b010001), dcuad(:,b010011),...
                     dcuad(:,b010101), dcuad(:,b010111),...
                     dcuad(:,b011001), dcuad(:,b011011),...
                     dcuad(:,b011101), dcuad(:,b011111),...
                     dcuad(:,b100001), dcuad(:,b100011),...
                     dcuad(:,b100101), dcuad(:,b100111),...
                     dcuad(:,b101001), dcuad(:,b101011),...
                     dcuad(:,b101101), dcuad(:,b101111),...
                     dcuad(:,b110001), dcuad(:,b110011),...
                     dcuad(:,b110101), dcuad(:,b110111),...
                     dcuad(:,b111001), dcuad(:,b111011),...
                     dcuad(:,b111101), dcuad(:,b111111)],[],2);

        lambda_5=(min_1-min_0)/N_post;

        dSr(1:6:end-5) = lambda_0;
        dSr(2:6:end-4) = lambda_1;
        dSr(3:6:end-3) = lambda_2;
        dSr(4:6:end-2) = lambda_3;
        dSr(5:6:end-1) = lambda_4;
        dSr(6:6:end) = lambda_5;

%         % Primer bucle para calcular la distancia media, que es la potencia
%         % de ruido
%         for s=1:Na
%             dcuad = (real(rX(s))*c-modI*c).^2 + (imag(rX(s))*c-modQ*c).^2;
%             % Me quedo con la mínima
%             min_dist(s) = min(dcuad);
%         end
%         N_AWGN = mean(min_dist);
%         
%         for s=1:Na
%             dcuad = (real(rX(s))-modI).^2 + (imag(rX(s))-modQ).^2;
% %             indice = (Nsc-Na)/2 + s + (s > Na/2);
% %             N_post = N_AWGN / (H(indice)*H(indice)');   % ruido de post-detección con ZF
%             N_post = N_AWGN;
%             
%             %bit 0
%             min_0 = min([dcuad(b000000), dcuad(b000001),...
%                          dcuad(b000010), dcuad(b000011),...
%                          dcuad(b000100), dcuad(b000101),...
%                          dcuad(b000110), dcuad(b000111),...
%                          dcuad(b001000), dcuad(b001001),...
%                          dcuad(b001010), dcuad(b001011),...
%                          dcuad(b001100), dcuad(b001101),...
%                          dcuad(b001110), dcuad(b001111),...
%                          dcuad(b010000), dcuad(b010001),...
%                          dcuad(b010010), dcuad(b010011),...
%                          dcuad(b010100), dcuad(b010101),...
%                          dcuad(b010110), dcuad(b010111),...
%                          dcuad(b011000), dcuad(b011001),...
%                          dcuad(b011010), dcuad(b011011),...
%                          dcuad(b011100), dcuad(b011101),...
%                          dcuad(b011110), dcuad(b011111)]);
% 
%             min_1 = min([dcuad(b100000), dcuad(b100001),...
%                          dcuad(b100010), dcuad(b100011),...
%                          dcuad(b100100), dcuad(b100101),...
%                          dcuad(b100110), dcuad(b100111),...
%                          dcuad(b101000), dcuad(b101001),...
%                          dcuad(b101010), dcuad(b101011),...
%                          dcuad(b101100), dcuad(b101101),...
%                          dcuad(b101110), dcuad(b101111),...
%                          dcuad(b110000), dcuad(b110001),...
%                          dcuad(b110010), dcuad(b110011),...
%                          dcuad(b110100), dcuad(b110101),...
%                          dcuad(b110110), dcuad(b110111),...
%                          dcuad(b111000), dcuad(b111001),...
%                          dcuad(b111010), dcuad(b111011),...
%                          dcuad(b111100), dcuad(b111101),...
%                          dcuad(b111110), dcuad(b111111)]);
%                          
%             lambda_0=(min_1-min_0)/N_post;
% 
%             %bit 1
%             min_0 = min([dcuad(b000000), dcuad(b000001),...
%                          dcuad(b000010), dcuad(b000011),...
%                          dcuad(b000100), dcuad(b000101),...
%                          dcuad(b000110), dcuad(b000111),...
%                          dcuad(b001000), dcuad(b001001),...
%                          dcuad(b001010), dcuad(b001011),...
%                          dcuad(b001100), dcuad(b001101),...
%                          dcuad(b001110), dcuad(b001111),...
%                          dcuad(b100000), dcuad(b100001),...
%                          dcuad(b100010), dcuad(b100011),...
%                          dcuad(b100100), dcuad(b100101),...
%                          dcuad(b100110), dcuad(b100111),...
%                          dcuad(b101000), dcuad(b101001),...
%                          dcuad(b101010), dcuad(b101011),...
%                          dcuad(b101100), dcuad(b101101),...
%                          dcuad(b101110), dcuad(b101111)]);
% 
%             min_1 = min([dcuad(b010000), dcuad(b010001),...
%                          dcuad(b010010), dcuad(b010011),...
%                          dcuad(b010100), dcuad(b010101),...
%                          dcuad(b010110), dcuad(b010111),...
%                          dcuad(b011000), dcuad(b011001),...
%                          dcuad(b011010), dcuad(b011011),...
%                          dcuad(b011100), dcuad(b011101),...
%                          dcuad(b011110), dcuad(b011111),...
%                          dcuad(b110000), dcuad(b110001),...
%                          dcuad(b110010), dcuad(b110011),...
%                          dcuad(b110100), dcuad(b110101),...
%                          dcuad(b110110), dcuad(b110111),...
%                          dcuad(b111000), dcuad(b111001),...
%                          dcuad(b111010), dcuad(b111011),...
%                          dcuad(b111100), dcuad(b111101),...
%                          dcuad(b111110), dcuad(b111111)]);
%                          
%             lambda_1=(min_1-min_0)/N_post;
%             
%             %bit 2
%             min_0 = min([dcuad(b000000), dcuad(b000001),...
%                          dcuad(b000010), dcuad(b000011),...
%                          dcuad(b000100), dcuad(b000101),...
%                          dcuad(b000110), dcuad(b000111),...
%                          dcuad(b010000), dcuad(b010001),...
%                          dcuad(b010010), dcuad(b010011),...
%                          dcuad(b010100), dcuad(b010101),...
%                          dcuad(b010110), dcuad(b010111),...
%                          dcuad(b100000), dcuad(b100001),...
%                          dcuad(b100010), dcuad(b100011),...
%                          dcuad(b100100), dcuad(b100101),...
%                          dcuad(b100110), dcuad(b100111),...
%                          dcuad(b110000), dcuad(b110001),...
%                          dcuad(b110010), dcuad(b110011),...
%                          dcuad(b110100), dcuad(b110101),...
%                          dcuad(b110110), dcuad(b110111)]);
% 
%             min_1 = min([dcuad(b001000), dcuad(b001001),...
%                          dcuad(b001010), dcuad(b001011),...
%                          dcuad(b001100), dcuad(b001101),...
%                          dcuad(b001110), dcuad(b001111),...
%                          dcuad(b011000), dcuad(b011001),...
%                          dcuad(b011010), dcuad(b011011),...
%                          dcuad(b011100), dcuad(b011101),...
%                          dcuad(b011110), dcuad(b011111),...
%                          dcuad(b101000), dcuad(b101001),...
%                          dcuad(b101010), dcuad(b101011),...
%                          dcuad(b101100), dcuad(b101101),...
%                          dcuad(b101110), dcuad(b101111),...
%                          dcuad(b111000), dcuad(b111001),...
%                          dcuad(b111010), dcuad(b111011),...
%                          dcuad(b111100), dcuad(b111101),...
%                          dcuad(b111110), dcuad(b111111)]);
%                                                 
%             lambda_2=(min_1-min_0)/N_post;
%             
%             %bit 3
%             min_0 = min([dcuad(b000000), dcuad(b000001),...
%                          dcuad(b000010), dcuad(b000011),...
%                          dcuad(b001000), dcuad(b001001),...
%                          dcuad(b001010), dcuad(b001011),...
%                          dcuad(b010000), dcuad(b010001),...
%                          dcuad(b010010), dcuad(b010011),...
%                          dcuad(b011000), dcuad(b011001),...
%                          dcuad(b011010), dcuad(b011011),...
%                          dcuad(b100000), dcuad(b100001),...
%                          dcuad(b100010), dcuad(b100011),...
%                          dcuad(b101000), dcuad(b101001),...
%                          dcuad(b101010), dcuad(b101011),...
%                          dcuad(b110000), dcuad(b110001),...
%                          dcuad(b110010), dcuad(b110011),...
%                          dcuad(b111000), dcuad(b111001),...
%                          dcuad(b111010), dcuad(b111011)]);
% 
%             min_1 = min([dcuad(b000100), dcuad(b000101),...
%                          dcuad(b000110), dcuad(b000111),...
%                          dcuad(b001100), dcuad(b001101),...
%                          dcuad(b001110), dcuad(b001111),...
%                          dcuad(b010100), dcuad(b010101),...
%                          dcuad(b010110), dcuad(b010111),...
%                          dcuad(b011100), dcuad(b011101),...
%                          dcuad(b011110), dcuad(b011111),...
%                          dcuad(b100100), dcuad(b100101),...
%                          dcuad(b100110), dcuad(b100111),...
%                          dcuad(b101100), dcuad(b101101),...
%                          dcuad(b101110), dcuad(b101111),...
%                          dcuad(b110100), dcuad(b110101),...
%                          dcuad(b110110), dcuad(b110111),...
%                          dcuad(b111100), dcuad(b111101),...
%                          dcuad(b111110), dcuad(b111111)]);
%                                                 
%             lambda_3=(min_1-min_0)/N_post;
% 
%             %bit 4
%             min_0 = min([dcuad(b000000), dcuad(b000001),...
%                          dcuad(b000100), dcuad(b000101),...
%                          dcuad(b001000), dcuad(b001001),...
%                          dcuad(b001100), dcuad(b001101),...
%                          dcuad(b010000), dcuad(b010001),...
%                          dcuad(b010100), dcuad(b010101),...
%                          dcuad(b011000), dcuad(b011001),...
%                          dcuad(b011100), dcuad(b011101),...
%                          dcuad(b100000), dcuad(b100001),...
%                          dcuad(b100100), dcuad(b100101),...
%                          dcuad(b101000), dcuad(b101001),...
%                          dcuad(b101100), dcuad(b101101),...
%                          dcuad(b110000), dcuad(b110001),...
%                          dcuad(b110100), dcuad(b110101),...
%                          dcuad(b111000), dcuad(b111001),...
%                          dcuad(b111100), dcuad(b111101)]);
% 
%             min_1 = min([dcuad(b000010), dcuad(b000011),...
%                          dcuad(b000110), dcuad(b000111),...
%                          dcuad(b001010), dcuad(b001011),...
%                          dcuad(b001110), dcuad(b001111),...
%                          dcuad(b010010), dcuad(b010011),...
%                          dcuad(b010110), dcuad(b010111),...
%                          dcuad(b011010), dcuad(b011011),...
%                          dcuad(b011110), dcuad(b011111),...
%                          dcuad(b100010), dcuad(b100011),...
%                          dcuad(b100110), dcuad(b100111),...
%                          dcuad(b101010), dcuad(b101011),...
%                          dcuad(b101110), dcuad(b101111),...
%                          dcuad(b110010), dcuad(b110011),...
%                          dcuad(b110110), dcuad(b110111),...
%                          dcuad(b111010), dcuad(b111011),...
%                          dcuad(b111110), dcuad(b111111)]);
%                                                 
%             lambda_4=(min_1-min_0)/N_post;
% 
%             %bit 5
%             min_0 = min([dcuad(b000000), dcuad(b000010),...
%                          dcuad(b000100), dcuad(b000110),...
%                          dcuad(b001000), dcuad(b001010),...
%                          dcuad(b001100), dcuad(b001110),...
%                          dcuad(b010000), dcuad(b010010),...
%                          dcuad(b010100), dcuad(b010110),...
%                          dcuad(b011000), dcuad(b011010),...
%                          dcuad(b011100), dcuad(b011110),...
%                          dcuad(b100000), dcuad(b100010),...
%                          dcuad(b100100), dcuad(b100110),...
%                          dcuad(b101000), dcuad(b101010),...
%                          dcuad(b101100), dcuad(b101110),...
%                          dcuad(b110000), dcuad(b110010),...
%                          dcuad(b110100), dcuad(b110110),...
%                          dcuad(b111000), dcuad(b111010),...
%                          dcuad(b111100), dcuad(b111110)]);
% 
%             min_1 = min([dcuad(b000001), dcuad(b000011),...
%                          dcuad(b000101), dcuad(b000111),...
%                          dcuad(b001001), dcuad(b001011),...
%                          dcuad(b001101), dcuad(b001111),...
%                          dcuad(b010001), dcuad(b010011),...
%                          dcuad(b010101), dcuad(b010111),...
%                          dcuad(b011001), dcuad(b011011),...
%                          dcuad(b011101), dcuad(b011111),...
%                          dcuad(b100001), dcuad(b100011),...
%                          dcuad(b100101), dcuad(b100111),...
%                          dcuad(b101001), dcuad(b101011),...
%                          dcuad(b101101), dcuad(b101111),...
%                          dcuad(b110001), dcuad(b110011),...
%                          dcuad(b110101), dcuad(b110111),...
%                          dcuad(b111001), dcuad(b111011),...
%                          dcuad(b111101), dcuad(b111111)]);
%                                                 
%             lambda_5=(min_1-min_0)/N_post;
% 
%             dSr(6*(s-1)+1) = lambda_0;
%             dSr(6*(s-1)+2) = lambda_1;
%             dSr(6*(s-1)+3) = lambda_2;
%             dSr(6*(s-1)+4) = lambda_3;
%             dSr(6*(s-1)+5) = lambda_4;
%             dSr(6*(s-1)+6) = lambda_5;

%             min_0=min([dcuad(find(strcmp(dist_ind, '000000'))),dcuad(find(strcmp(dist_ind, '000001'))),...
%                 dcuad(find(strcmp(dist_ind, '000010'))),dcuad(find(strcmp(dist_ind, '000011'))),...
%                 dcuad(find(strcmp(dist_ind, '000100'))),dcuad(find(strcmp(dist_ind, '000101'))),...
%                 dcuad(find(strcmp(dist_ind, '000110'))),dcuad(find(strcmp(dist_ind, '000111'))),...
%                 dcuad(find(strcmp(dist_ind, '001000'))),dcuad(find(strcmp(dist_ind, '001001'))),...
%                 dcuad(find(strcmp(dist_ind, '001010'))),dcuad(find(strcmp(dist_ind, '001011'))),...
%                 dcuad(find(strcmp(dist_ind, '001100'))),dcuad(find(strcmp(dist_ind, '001101'))),...
%                 dcuad(find(strcmp(dist_ind, '001110'))),dcuad(find(strcmp(dist_ind, '001111'))),...
%                 dcuad(find(strcmp(dist_ind, '100000'))),dcuad(find(strcmp(dist_ind, '100001'))),...
%                 dcuad(find(strcmp(dist_ind, '100010'))),dcuad(find(strcmp(dist_ind, '100011'))),...
%                 dcuad(find(strcmp(dist_ind, '100100'))),dcuad(find(strcmp(dist_ind, '100101'))),...
%                 dcuad(find(strcmp(dist_ind, '100110'))),dcuad(find(strcmp(dist_ind, '100111'))),...
%                 dcuad(find(strcmp(dist_ind, '101000'))),dcuad(find(strcmp(dist_ind, '101001'))),...
%                 dcuad(find(strcmp(dist_ind, '101010'))),dcuad(find(strcmp(dist_ind, '101011'))),...
%                 dcuad(find(strcmp(dist_ind, '101100'))),dcuad(find(strcmp(dist_ind, '101101'))),...
%                 dcuad(find(strcmp(dist_ind, '101110'))),dcuad(find(strcmp(dist_ind, '101111')))]);
% 
%             min_1=min([dcuad(find(strcmp(dist_ind, '010000'))),dcuad(find(strcmp(dist_ind, '010001'))),...
%                 dcuad(find(strcmp(dist_ind, '010010'))),dcuad(find(strcmp(dist_ind, '010011'))),...
%                 dcuad(find(strcmp(dist_ind, '010100'))),dcuad(find(strcmp(dist_ind, '010101'))),...
%                 dcuad(find(strcmp(dist_ind, '010110'))),dcuad(find(strcmp(dist_ind, '010111'))),...
%                 dcuad(find(strcmp(dist_ind, '011000'))),dcuad(find(strcmp(dist_ind, '011001'))),...
%                 dcuad(find(strcmp(dist_ind, '011010'))),dcuad(find(strcmp(dist_ind, '011011'))),...
%                 dcuad(find(strcmp(dist_ind, '011100'))),dcuad(find(strcmp(dist_ind, '011101'))),...
%                 dcuad(find(strcmp(dist_ind, '011110'))),dcuad(find(strcmp(dist_ind, '011111'))),...
%                 dcuad(find(strcmp(dist_ind, '110000'))),dcuad(find(strcmp(dist_ind, '110001'))),...
%                 dcuad(find(strcmp(dist_ind, '110010'))),dcuad(find(strcmp(dist_ind, '110011'))),...
%                 dcuad(find(strcmp(dist_ind, '110100'))),dcuad(find(strcmp(dist_ind, '110101'))),...
%                 dcuad(find(strcmp(dist_ind, '110110'))),dcuad(find(strcmp(dist_ind, '110111'))),...
%                 dcuad(find(strcmp(dist_ind, '111000'))),dcuad(find(strcmp(dist_ind, '111001'))),...
%                 dcuad(find(strcmp(dist_ind, '111010'))),dcuad(find(strcmp(dist_ind, '111011'))),...
%                 dcuad(find(strcmp(dist_ind, '111100'))),dcuad(find(strcmp(dist_ind, '111101'))),...
%                 dcuad(find(strcmp(dist_ind, '111110'))),dcuad(find(strcmp(dist_ind, '111111')))]);
% 
%             lambda_1=(min_1-min_0)/N;
% 
%             min_1=min([dcuad(find(strcmp(dist_ind, '100000'))),dcuad(find(strcmp(dist_ind, '100001'))),...
%                 dcuad(find(strcmp(dist_ind, '100010'))),dcuad(find(strcmp(dist_ind, '100011'))),...
%                 dcuad(find(strcmp(dist_ind, '100100'))),dcuad(find(strcmp(dist_ind, '100101'))),...
%                 dcuad(find(strcmp(dist_ind, '100110'))),dcuad(find(strcmp(dist_ind, '100111'))),...
%                 dcuad(find(strcmp(dist_ind, '101000'))),dcuad(find(strcmp(dist_ind, '101001'))),...
%                 dcuad(find(strcmp(dist_ind, '101010'))),dcuad(find(strcmp(dist_ind, '101011'))),...
%                 dcuad(find(strcmp(dist_ind, '101100'))),dcuad(find(strcmp(dist_ind, '101101'))),...
%                 dcuad(find(strcmp(dist_ind, '101110'))),dcuad(find(strcmp(dist_ind, '101111'))),...
%                 dcuad(find(strcmp(dist_ind, '110000'))),dcuad(find(strcmp(dist_ind, '110001'))),...
%                 dcuad(find(strcmp(dist_ind, '110010'))),dcuad(find(strcmp(dist_ind, '110011'))),...
%                 dcuad(find(strcmp(dist_ind, '110100'))),dcuad(find(strcmp(dist_ind, '110101'))),...
%                 dcuad(find(strcmp(dist_ind, '110110'))),dcuad(find(strcmp(dist_ind, '110111'))),...
%                 dcuad(find(strcmp(dist_ind, '111000'))),dcuad(find(strcmp(dist_ind, '111001'))),...
%                 dcuad(find(strcmp(dist_ind, '111010'))),dcuad(find(strcmp(dist_ind, '111011'))),...
%                 dcuad(find(strcmp(dist_ind, '111100'))),dcuad(find(strcmp(dist_ind, '111101'))),...
%                 dcuad(find(strcmp(dist_ind, '111110'))),dcuad(find(strcmp(dist_ind, '111111')))]);
% 
%             lambda_0=(min_1-min_0)/N;
% 
% 
%             %bit1
%             min_0=min([dcuad(find(strcmp(dist_ind, '000000'))),dcuad(find(strcmp(dist_ind, '000001'))),...
%                 dcuad(find(strcmp(dist_ind, '000010'))),dcuad(find(strcmp(dist_ind, '000011'))),...
%                 dcuad(find(strcmp(dist_ind, '000100'))),dcuad(find(strcmp(dist_ind, '000101'))),...
%                 dcuad(find(strcmp(dist_ind, '000110'))),dcuad(find(strcmp(dist_ind, '000111'))),...
%                 dcuad(find(strcmp(dist_ind, '001000'))),dcuad(find(strcmp(dist_ind, '001001'))),...
%                 dcuad(find(strcmp(dist_ind, '001010'))),dcuad(find(strcmp(dist_ind, '001011'))),...
%                 dcuad(find(strcmp(dist_ind, '001100'))),dcuad(find(strcmp(dist_ind, '001101'))),...
%                 dcuad(find(strcmp(dist_ind, '001110'))),dcuad(find(strcmp(dist_ind, '001111'))),...
%                 dcuad(find(strcmp(dist_ind, '100000'))),dcuad(find(strcmp(dist_ind, '100001'))),...
%                 dcuad(find(strcmp(dist_ind, '100010'))),dcuad(find(strcmp(dist_ind, '100011'))),...
%                 dcuad(find(strcmp(dist_ind, '100100'))),dcuad(find(strcmp(dist_ind, '100101'))),...
%                 dcuad(find(strcmp(dist_ind, '100110'))),dcuad(find(strcmp(dist_ind, '100111'))),...
%                 dcuad(find(strcmp(dist_ind, '101000'))),dcuad(find(strcmp(dist_ind, '101001'))),...
%                 dcuad(find(strcmp(dist_ind, '101010'))),dcuad(find(strcmp(dist_ind, '101011'))),...
%                 dcuad(find(strcmp(dist_ind, '101100'))),dcuad(find(strcmp(dist_ind, '101101'))),...
%                 dcuad(find(strcmp(dist_ind, '101110'))),dcuad(find(strcmp(dist_ind, '101111')))]);
% 
%             min_1=min([dcuad(find(strcmp(dist_ind, '010000'))),dcuad(find(strcmp(dist_ind, '010001'))),...
%                 dcuad(find(strcmp(dist_ind, '010010'))),dcuad(find(strcmp(dist_ind, '010011'))),...
%                 dcuad(find(strcmp(dist_ind, '010100'))),dcuad(find(strcmp(dist_ind, '010101'))),...
%                 dcuad(find(strcmp(dist_ind, '010110'))),dcuad(find(strcmp(dist_ind, '010111'))),...
%                 dcuad(find(strcmp(dist_ind, '011000'))),dcuad(find(strcmp(dist_ind, '011001'))),...
%                 dcuad(find(strcmp(dist_ind, '011010'))),dcuad(find(strcmp(dist_ind, '011011'))),...
%                 dcuad(find(strcmp(dist_ind, '011100'))),dcuad(find(strcmp(dist_ind, '011101'))),...
%                 dcuad(find(strcmp(dist_ind, '011110'))),dcuad(find(strcmp(dist_ind, '011111'))),...
%                 dcuad(find(strcmp(dist_ind, '110000'))),dcuad(find(strcmp(dist_ind, '110001'))),...
%                 dcuad(find(strcmp(dist_ind, '110010'))),dcuad(find(strcmp(dist_ind, '110011'))),...
%                 dcuad(find(strcmp(dist_ind, '110100'))),dcuad(find(strcmp(dist_ind, '110101'))),...
%                 dcuad(find(strcmp(dist_ind, '110110'))),dcuad(find(strcmp(dist_ind, '110111'))),...
%                 dcuad(find(strcmp(dist_ind, '111000'))),dcuad(find(strcmp(dist_ind, '111001'))),...
%                 dcuad(find(strcmp(dist_ind, '111010'))),dcuad(find(strcmp(dist_ind, '111011'))),...
%                 dcuad(find(strcmp(dist_ind, '111100'))),dcuad(find(strcmp(dist_ind, '111101'))),...
%                 dcuad(find(strcmp(dist_ind, '111110'))),dcuad(find(strcmp(dist_ind, '111111')))]);
% 
%             lambda_1=(min_1-min_0)/N;
% 
%             %bit2
%             min_0=min([dcuad(find(strcmp(dist_ind, '000000'))),dcuad(find(strcmp(dist_ind, '000001'))),...
%                 dcuad(find(strcmp(dist_ind, '000010'))),dcuad(find(strcmp(dist_ind, '000011'))),...
%                 dcuad(find(strcmp(dist_ind, '000100'))),dcuad(find(strcmp(dist_ind, '000101'))),...
%                 dcuad(find(strcmp(dist_ind, '000110'))),dcuad(find(strcmp(dist_ind, '000111'))),...
%                 dcuad(find(strcmp(dist_ind, '010000'))),dcuad(find(strcmp(dist_ind, '010001'))),...
%                 dcuad(find(strcmp(dist_ind, '010010'))),dcuad(find(strcmp(dist_ind, '010011'))),...
%                 dcuad(find(strcmp(dist_ind, '010100'))),dcuad(find(strcmp(dist_ind, '010101'))),...
%                 dcuad(find(strcmp(dist_ind, '010110'))),dcuad(find(strcmp(dist_ind, '010111'))),...
%                 dcuad(find(strcmp(dist_ind, '100000'))),dcuad(find(strcmp(dist_ind, '100001'))),...
%                 dcuad(find(strcmp(dist_ind, '100010'))),dcuad(find(strcmp(dist_ind, '100011'))),...
%                 dcuad(find(strcmp(dist_ind, '100100'))),dcuad(find(strcmp(dist_ind, '100101'))),...
%                 dcuad(find(strcmp(dist_ind, '100110'))),dcuad(find(strcmp(dist_ind, '100111'))),...
%                 dcuad(find(strcmp(dist_ind, '110000'))),dcuad(find(strcmp(dist_ind, '110001'))),...
%                 dcuad(find(strcmp(dist_ind, '110010'))),dcuad(find(strcmp(dist_ind, '110011'))),...
%                 dcuad(find(strcmp(dist_ind, '110100'))),dcuad(find(strcmp(dist_ind, '110101'))),...
%                 dcuad(find(strcmp(dist_ind, '110110'))),dcuad(find(strcmp(dist_ind, '110111')))]);
% 
%             min_1=min([dcuad(find(strcmp(dist_ind, '001000'))),dcuad(find(strcmp(dist_ind, '001001'))),...
%                 dcuad(find(strcmp(dist_ind, '001010'))),dcuad(find(strcmp(dist_ind, '001011'))),...
%                 dcuad(find(strcmp(dist_ind, '001100'))),dcuad(find(strcmp(dist_ind, '001101'))),...
%                 dcuad(find(strcmp(dist_ind, '001110'))),dcuad(find(strcmp(dist_ind, '001111'))),...
%                 dcuad(find(strcmp(dist_ind, '011000'))),dcuad(find(strcmp(dist_ind, '011001'))),...
%                 dcuad(find(strcmp(dist_ind, '011010'))),dcuad(find(strcmp(dist_ind, '011011'))),...
%                 dcuad(find(strcmp(dist_ind, '011100'))),dcuad(find(strcmp(dist_ind, '011101'))),...
%                 dcuad(find(strcmp(dist_ind, '011110'))),dcuad(find(strcmp(dist_ind, '011111'))),...
%                 dcuad(find(strcmp(dist_ind, '101000'))),dcuad(find(strcmp(dist_ind, '101001'))),...
%                 dcuad(find(strcmp(dist_ind, '101010'))),dcuad(find(strcmp(dist_ind, '101011'))),...
%                 dcuad(find(strcmp(dist_ind, '101100'))),dcuad(find(strcmp(dist_ind, '101101'))),...
%                 dcuad(find(strcmp(dist_ind, '101110'))),dcuad(find(strcmp(dist_ind, '101111'))),...
%                 dcuad(find(strcmp(dist_ind, '111000'))),dcuad(find(strcmp(dist_ind, '111001'))),...
%                 dcuad(find(strcmp(dist_ind, '111010'))),dcuad(find(strcmp(dist_ind, '111011'))),...
%                 dcuad(find(strcmp(dist_ind, '111100'))),dcuad(find(strcmp(dist_ind, '111101'))),...
%                 dcuad(find(strcmp(dist_ind, '111110'))),dcuad(find(strcmp(dist_ind, '111111')))]);
% 
%             lambda_2=(min_1-min_0)/N;
% 
%              %bit3
%             min_0=min([dcuad(find(strcmp(dist_ind, '000000'))),dcuad(find(strcmp(dist_ind, '000001'))),...
%                 dcuad(find(strcmp(dist_ind, '000010'))),dcuad(find(strcmp(dist_ind, '000011'))),...
%                 dcuad(find(strcmp(dist_ind, '001000'))),dcuad(find(strcmp(dist_ind, '001001'))),...
%                 dcuad(find(strcmp(dist_ind, '001010'))),dcuad(find(strcmp(dist_ind, '001011'))),...
%                 dcuad(find(strcmp(dist_ind, '010000'))),dcuad(find(strcmp(dist_ind, '010001'))),...
%                 dcuad(find(strcmp(dist_ind, '010010'))),dcuad(find(strcmp(dist_ind, '010011'))),...
%                 dcuad(find(strcmp(dist_ind, '011000'))),dcuad(find(strcmp(dist_ind, '011001'))),...
%                 dcuad(find(strcmp(dist_ind, '011010'))),dcuad(find(strcmp(dist_ind, '011011'))),...
%                 dcuad(find(strcmp(dist_ind, '100000'))),dcuad(find(strcmp(dist_ind, '100001'))),...
%                 dcuad(find(strcmp(dist_ind, '100010'))),dcuad(find(strcmp(dist_ind, '100011'))),...
%                 dcuad(find(strcmp(dist_ind, '101000'))),dcuad(find(strcmp(dist_ind, '101001'))),...
%                 dcuad(find(strcmp(dist_ind, '101010'))),dcuad(find(strcmp(dist_ind, '101011'))),...
%                 dcuad(find(strcmp(dist_ind, '110000'))),dcuad(find(strcmp(dist_ind, '110001'))),...
%                 dcuad(find(strcmp(dist_ind, '110010'))),dcuad(find(strcmp(dist_ind, '110011'))),...
%                 dcuad(find(strcmp(dist_ind, '111000'))),dcuad(find(strcmp(dist_ind, '111001'))),...
%                 dcuad(find(strcmp(dist_ind, '111010'))),dcuad(find(strcmp(dist_ind, '111011')))]);
% 
%             min_1=min([dcuad(find(strcmp(dist_ind, '000100'))),dcuad(find(strcmp(dist_ind, '000101'))),...
%                 dcuad(find(strcmp(dist_ind, '000110'))),dcuad(find(strcmp(dist_ind, '000111'))),...
%                 dcuad(find(strcmp(dist_ind, '001100'))),dcuad(find(strcmp(dist_ind, '001101'))),...
%                 dcuad(find(strcmp(dist_ind, '001110'))),dcuad(find(strcmp(dist_ind, '001111'))),...
%                 dcuad(find(strcmp(dist_ind, '010100'))),dcuad(find(strcmp(dist_ind, '010101'))),...
%                 dcuad(find(strcmp(dist_ind, '010110'))),dcuad(find(strcmp(dist_ind, '010111'))),...
%                 dcuad(find(strcmp(dist_ind, '011100'))),dcuad(find(strcmp(dist_ind, '011101'))),...
%                 dcuad(find(strcmp(dist_ind, '011110'))),dcuad(find(strcmp(dist_ind, '011111'))),...
%                 dcuad(find(strcmp(dist_ind, '100100'))),dcuad(find(strcmp(dist_ind, '100101'))),...
%                 dcuad(find(strcmp(dist_ind, '100110'))),dcuad(find(strcmp(dist_ind, '100111'))),...
%                 dcuad(find(strcmp(dist_ind, '101100'))),dcuad(find(strcmp(dist_ind, '101101'))),...
%                 dcuad(find(strcmp(dist_ind, '101110'))),dcuad(find(strcmp(dist_ind, '101111'))),...
%                 dcuad(find(strcmp(dist_ind, '110100'))),dcuad(find(strcmp(dist_ind, '110101'))),...
%                 dcuad(find(strcmp(dist_ind, '110110'))),dcuad(find(strcmp(dist_ind, '110111'))),...
%                 dcuad(find(strcmp(dist_ind, '111100'))),dcuad(find(strcmp(dist_ind, '111101'))),...
%                 dcuad(find(strcmp(dist_ind, '111110'))),dcuad(find(strcmp(dist_ind, '111111')))]);
% 
%             lambda_3=(min_1-min_0)/N;
% 
%              %bit4
%             min_0=min([dcuad(find(strcmp(dist_ind, '000000'))),dcuad(find(strcmp(dist_ind, '000001'))),...
%                 dcuad(find(strcmp(dist_ind, '000100'))),dcuad(find(strcmp(dist_ind, '000101'))),...
%                 dcuad(find(strcmp(dist_ind, '001000'))),dcuad(find(strcmp(dist_ind, '001001'))),...
%                 dcuad(find(strcmp(dist_ind, '001100'))),dcuad(find(strcmp(dist_ind, '001101'))),...
%                 dcuad(find(strcmp(dist_ind, '010000'))),dcuad(find(strcmp(dist_ind, '010001'))),...
%                 dcuad(find(strcmp(dist_ind, '010100'))),dcuad(find(strcmp(dist_ind, '010101'))),...
%                 dcuad(find(strcmp(dist_ind, '011000'))),dcuad(find(strcmp(dist_ind, '011001'))),...
%                 dcuad(find(strcmp(dist_ind, '011100'))),dcuad(find(strcmp(dist_ind, '011101'))),...
%                 dcuad(find(strcmp(dist_ind, '100000'))),dcuad(find(strcmp(dist_ind, '100001'))),...
%                 dcuad(find(strcmp(dist_ind, '100100'))),dcuad(find(strcmp(dist_ind, '100101'))),...
%                 dcuad(find(strcmp(dist_ind, '101000'))),dcuad(find(strcmp(dist_ind, '101001'))),...
%                 dcuad(find(strcmp(dist_ind, '101100'))),dcuad(find(strcmp(dist_ind, '101101'))),...
%                 dcuad(find(strcmp(dist_ind, '110000'))),dcuad(find(strcmp(dist_ind, '110001'))),...
%                 dcuad(find(strcmp(dist_ind, '110100'))),dcuad(find(strcmp(dist_ind, '110101'))),...
%                 dcuad(find(strcmp(dist_ind, '111000'))),dcuad(find(strcmp(dist_ind, '111001'))),...
%                 dcuad(find(strcmp(dist_ind, '111100'))),dcuad(find(strcmp(dist_ind, '111101')))]);
% 
%             min_1=min([dcuad(find(strcmp(dist_ind, '000010'))),dcuad(find(strcmp(dist_ind, '000011'))),...
%                 dcuad(find(strcmp(dist_ind, '000110'))),dcuad(find(strcmp(dist_ind, '000111'))),...
%                 dcuad(find(strcmp(dist_ind, '001010'))),dcuad(find(strcmp(dist_ind, '001011'))),...
%                 dcuad(find(strcmp(dist_ind, '001110'))),dcuad(find(strcmp(dist_ind, '001111'))),...
%                 dcuad(find(strcmp(dist_ind, '010010'))),dcuad(find(strcmp(dist_ind, '010011'))),...
%                 dcuad(find(strcmp(dist_ind, '010110'))),dcuad(find(strcmp(dist_ind, '010111'))),...
%                 dcuad(find(strcmp(dist_ind, '011010'))),dcuad(find(strcmp(dist_ind, '011011'))),...
%                 dcuad(find(strcmp(dist_ind, '011110'))),dcuad(find(strcmp(dist_ind, '011111'))),...
%                 dcuad(find(strcmp(dist_ind, '100010'))),dcuad(find(strcmp(dist_ind, '100011'))),...
%                 dcuad(find(strcmp(dist_ind, '100110'))),dcuad(find(strcmp(dist_ind, '100111'))),...
%                 dcuad(find(strcmp(dist_ind, '101010'))),dcuad(find(strcmp(dist_ind, '101011'))),...
%                 dcuad(find(strcmp(dist_ind, '101110'))),dcuad(find(strcmp(dist_ind, '101111'))),...
%                 dcuad(find(strcmp(dist_ind, '110010'))),dcuad(find(strcmp(dist_ind, '110011'))),...
%                 dcuad(find(strcmp(dist_ind, '110110'))),dcuad(find(strcmp(dist_ind, '110111'))),...
%                 dcuad(find(strcmp(dist_ind, '111010'))),dcuad(find(strcmp(dist_ind, '111011'))),...
%                 dcuad(find(strcmp(dist_ind, '111110'))),dcuad(find(strcmp(dist_ind, '111111')))]);
% 
% 
%             lambda_4=(min_1-min_0)/N;
%             
%         %bit5
%             min_0=min([dcuad(find(strcmp(dist_ind, '000000'))),dcuad(find(strcmp(dist_ind, '000010'))),...
%                 dcuad(find(strcmp(dist_ind, '000100'))),dcuad(find(strcmp(dist_ind, '000110'))),...
%                 dcuad(find(strcmp(dist_ind, '001000'))),dcuad(find(strcmp(dist_ind, '001010'))),...
%                 dcuad(find(strcmp(dist_ind, '001100'))),dcuad(find(strcmp(dist_ind, '001110'))),...
%                 dcuad(find(strcmp(dist_ind, '010000'))),dcuad(find(strcmp(dist_ind, '010010'))),...
%                 dcuad(find(strcmp(dist_ind, '010100'))),dcuad(find(strcmp(dist_ind, '010110'))),...
%                 dcuad(find(strcmp(dist_ind, '011000'))),dcuad(find(strcmp(dist_ind, '011010'))),...
%                 dcuad(find(strcmp(dist_ind, '011100'))),dcuad(find(strcmp(dist_ind, '011110'))),...
%                 dcuad(find(strcmp(dist_ind, '100000'))),dcuad(find(strcmp(dist_ind, '100010'))),...
%                 dcuad(find(strcmp(dist_ind, '100100'))),dcuad(find(strcmp(dist_ind, '100110'))),...
%                 dcuad(find(strcmp(dist_ind, '101000'))),dcuad(find(strcmp(dist_ind, '101010'))),...
%                 dcuad(find(strcmp(dist_ind, '101100'))),dcuad(find(strcmp(dist_ind, '101110'))),...
%                 dcuad(find(strcmp(dist_ind, '110000'))),dcuad(find(strcmp(dist_ind, '110010'))),...
%                 dcuad(find(strcmp(dist_ind, '110100'))),dcuad(find(strcmp(dist_ind, '110110'))),...
%                 dcuad(find(strcmp(dist_ind, '111000'))),dcuad(find(strcmp(dist_ind, '111010'))),...
%                 dcuad(find(strcmp(dist_ind, '111100'))),dcuad(find(strcmp(dist_ind, '111110')))]);
% 
%             min_1=min([dcuad(find(strcmp(dist_ind, '000001'))),dcuad(find(strcmp(dist_ind, '000011'))),...
%                 dcuad(find(strcmp(dist_ind, '000101'))),dcuad(find(strcmp(dist_ind, '000111'))),...
%                 dcuad(find(strcmp(dist_ind, '001001'))),dcuad(find(strcmp(dist_ind, '001011'))),...
%                 dcuad(find(strcmp(dist_ind, '001101'))),dcuad(find(strcmp(dist_ind, '001111'))),...
%                 dcuad(find(strcmp(dist_ind, '010001'))),dcuad(find(strcmp(dist_ind, '010011'))),...
%                 dcuad(find(strcmp(dist_ind, '010101'))),dcuad(find(strcmp(dist_ind, '010111'))),...
%                 dcuad(find(strcmp(dist_ind, '011001'))),dcuad(find(strcmp(dist_ind, '011011'))),...
%                 dcuad(find(strcmp(dist_ind, '011101'))),dcuad(find(strcmp(dist_ind, '011111'))),...
%                 dcuad(find(strcmp(dist_ind, '100001'))),dcuad(find(strcmp(dist_ind, '100011'))),...
%                 dcuad(find(strcmp(dist_ind, '100101'))),dcuad(find(strcmp(dist_ind, '100111'))),...
%                 dcuad(find(strcmp(dist_ind, '101001'))),dcuad(find(strcmp(dist_ind, '101011'))),...
%                 dcuad(find(strcmp(dist_ind, '101101'))),dcuad(find(strcmp(dist_ind, '101111'))),...
%                 dcuad(find(strcmp(dist_ind, '110001'))),dcuad(find(strcmp(dist_ind, '110011'))),...
%                 dcuad(find(strcmp(dist_ind, '110101'))),dcuad(find(strcmp(dist_ind, '110111'))),...
%                 dcuad(find(strcmp(dist_ind, '111001'))),dcuad(find(strcmp(dist_ind, '111011'))),...
%                 dcuad(find(strcmp(dist_ind, '111101'))),dcuad(find(strcmp(dist_ind, '111111')))]);
% 
%             lambda_5=(min_1-min_0)/N;
% 
%             dSr=[dSr lambda_0 lambda_1 lambda_2 lambda_3 lambda_4 lambda_5];

%         end   

end
end